{extend name="common@Public/base" /} {block name="head"}
<link rel="STYLESHEET" type="text/css"
	href="__STATIC__/handsontable-pro/handsontable.full.min.css">
<script src="__STATIC__/handsontable-pro/handsontable.full.min.js"></script>
{/block} {block name="leftmenu"} {include
file="Common/leftmenu_zx_apply_manage" /} {/block} {block name="main"}
<div class="htmltitle">
	<h2>信息查询</h2>
</div>
<div>
	上方显示搜索框、 <br> query 显示全量，默认定位到最新日期。


</div>
<div style="width: 100%;">
	<div id='queryTable'></div>
</div>
{/block} {block name="script"}
<script>
	$(function($) {
		//$(".wtHolder")[0].style.height="";	//修复wtHolder层（handsontable右键菜单）height过大。
		$.post("", null, function(data) {
			//infoData = data;
			hot.render();
		});
	});
	var colWidthsData = "{$colWidthsData}";
	var zxTypeData = "互联网,营业厅,平安校园,点对点,卫生网,教育网,IMS,其他";
	//var aStationData = "柴河局,西丰新局,西丰老局,昌图新局,昌图老局,开原老局,开原新局,清河,调兵山新局,铁岭县,银州区";
	var aStationData = "{$aStationData}";
	var neFactoryData = "华为,中兴";
	var colHeaderData = "{$colHeaderData}";
	var container = document.getElementById('queryTable');
	var infoData, hot, columnsData, contextMenuData;
	infoData = [ new Array(34) ];
	hot = new Handsontable(container, {
		data : infoData,
		rowHeaders : true,
		colWidths : colWidthsData.split(","),
		//autoColumnSize : true,
		//filters : true,
		//search : true,
		//minSpareRows : 1,
		manualColumnResize : true,
		colHeaders : colHeaderData.split(","),
		columns : columnsData,
		contextMenu : contextMenuData
	});
	hot.validateCells();
	columnsData = [ {
		data : 'instanceId',
		type : 'numeric'
	}, {
		data : 'zxType',
		editor : 'select',
		selectOptions : zxTypeData.split(","),
	}, {
		data : 'bandWidth',
	}, {
		data : 'neFactory',
		editor : 'select',
		selectOptions : neFactoryData.split(","),
	}, {
		data : 'aStation',
		strict : true,
		type : 'autocomplete',
		source : aStationData.split(","),
	}, {
		data : 'cName',
	}, {
		data : 'cAddress',
	}, {
		data : 'cNeeds',
	}, {
		data : 'vlan',
		type : 'numeric',
	}, {
		data : 'ip',
		validator : "my.ipstr"
	}, {
		data : 'ipB',
		validator : "my.ipstr"
	}, {
		data: 'cPerson',
	}, {
		data: 'cPhone',
	}, {
		data: 'cEmail',
	}, {
		data: 'mPerson',
	}, {
		data: 'mPhone',
	}, {
		data: 'mEmail',
	}, {
		data: 'marks',
	}, {
		data: 'ifOnu',
	}, {
		data: 'oltName',
	}, {
		data: 'aPerson',
	}, {
		data: 'aEmail',
	}, {
		data: 'create_time',
		type : "date",
		dateFormat : "YYYY-MM-DD",
		correctFormat : true,
		validator : "date"
	},  {
		data: 'status',
	}, {
		data: 'tags',
	}, {
		data: 'unitProperty',
		type : 'numeric',
	}, {
		data: 'unitCategory',
		type : 'numeric',
	}, {
		data: 'industryCategory',
		type : 'numeric',
	}, {
		data: 'credential',
		type : 'numeric',
	}, {
		data: 'credentialnum',
	}, {
		data: 'province',
		type : 'numeric',
	}, {
		data: 'city',
		type : 'numeric',
	}, {
		data: 'county',
		type : 'numeric',
	}, {
		data: 'appServType',
		type : 'numeric',
	} ];
	contextMenuData = {
		callback : function(key, options) {
			if (key === 'about') {
				setTimeout(function() {
					// timeout is used to make sure the menu collapsed before alert is shown
					parent.dhtmlx.alert({
						title : "特别鸣谢",
						text : "本菜单由 Xianda 汉化。感谢Xianda"
					});
				}, 100);
			}
		},
		items : {
			"about" : {
				name : "*Power by Xianda*"
			},
			"hsep1" : "---------",
			"row_above" : {
				name : "在上面插入一行"
			},
			"row_below" : {
				name : "在下面插入一行"
			},
			"hsep1" : "---------",
			"col_left" : {
				name : "在左侧插入一列"
			},
			"col_right" : {
				name : "在右侧插入一列"
			},
			"hsep2" : "---------",
			"remove_row" : {
				name : "移除此行"
			},
			"remove_col" : {
				name : "移除次列"
			},
			"hsep3" : "---------",
			"undo" : {
				name : "撤销"
			},
			"redo" : {
				name : "还原"
			},
			"make_read_only" : {
				name : "设为只读"
			},
			"alignment" : {
				name : "对齐"
			},

		},
	};
	(function(Handsontable) {
		function ipstr(value, callback) {
			var a = value.split("/");
			var c = a[0].toString().match(
					/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);
			var b = a.length == 1 ? true : a.length > 2 ? false
					: parseInt(a[1]) <= 32 && a[1].match(/^\d{0,2}$/);
			callback(c
					&& !!(c[1] <= 255 && c[2] <= 255 && c[3] <= 255 && c[4] <= 255)
					&& b || false);
		}
		Handsontable.validators.registerValidator('my.ipstr', ipstr);
	})(Handsontable);
</script>
{/block}
