{extend name="common@Public/base" /} {block name="leftmenu"} {include
file="Common/leftmenu_zx_apply_index" /} {/block}{block name="head"}
<style>
#form_container {
	width: 900px;
}
</style>
{/block}{block name="main"}
<div class="htmltitle">
	<h2>数据专线申请</h2>
</div>
<div id="form_container">


</div>
{/block}
{block name="script"}
{include file="Common/_formStructure" /}
{include file="Common/_formConfig" /}
<script>
var myForm = new dhtmlXForm("form_container", formStructure);
myForm.enableLiveValidation(true);
initCombo();
function initCombo(){
	var combo;
	for (var cfg_d in config["default"]){
		myForm.reloadOptions(cfg_d,config["default"][cfg_d]);
		myForm.getCombo(cfg_d) && myForm.getCombo(cfg_d).enableFilteringMode("between");
	}
	for (var cfg_m in config["muticolumn"]){
		combo = myForm.getCombo(cfg_m);
		if(null == combo){
			continue;
		}
		combo.clearAll();
		combo.setTemplate({
			input:"#id#-#MC#",
			//header:false,//if you want to hide header
			columns:[
				{header:"id",width:60,option:"#id#"},
				{header:"MC",width:180,option:"#MC#"}
			]
		});
		combo.addOption(config["muticolumn"][cfg_m]);
		combo.enableFilteringMode("between");
	}
}
myForm.attachEvent("onButtonClick", function(id) {
	if(id == "commit"){
		if(myForm.validate()){
			var myData = myForm.getFormData();
			$.post("",myData,function(data){
				data.code == 1 && dhtmlx.alert({
					title:"&nbsp;",
					text:"提交成功。",
					callback:function(){
						location.href = "query.html";
					},
				});
				data.code == 0 && dhtmlx.alert({type:"alert-error",title:"提交失败",text:"请重试或联系管理员。"});
			});
		}else{
			dhtmlx.alert({type:"alert-error",title:"数据验证有误",text:"请检查填写是否完整或格式类型是否正确。"});
		}
	}
	if(id == "test"){
		myForm.setFormData({
			instanceId:"91001234567",cName:"cName",cAddress:"cAddress",cNeeds:"cNeeds",cPerson:"cPersion",cPhone:1,cEmail:"1@1.com",mPerson:"mPersion",mPhone:2,mEmail:"2@2.com",unitCategory:2,industryCategory:3,credential:3,credentialnum:"112345zzz6789",county:211202,appServType:4
		});
	}

});

</script>
{/block}
